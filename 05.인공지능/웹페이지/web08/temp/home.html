<div class="my-5">
    <h1 class="text-center mb-5">{{title}}</h1>
    <div class="row">
        <div class="col">
            <div class="input-group">
                <select id="code" class="form-select">
                    <option value="005930">삼성전자</option>
                    <option value="035720">카카오</option>
                    <option value="035420">NAVER</option>
                    <option value="005380">현대차</option>
                    <option value="066570">LG전자</option>
                </select>
                <input id="start" value="2025-01-01" type="date" class="form-control">
                <input id="end" value="2025-09-30" type="date" class="form-control">
                <button id="search" class="btn btn-success">검색</button>
            </div>
        </div>
        {% include 'tab.html' %}
    </div>
</div>

<script>
    let currentPage = 1;
    const totalPages = 10;
    $("#buttons").hide();

    function updateButtons() {
        $("#buttons span").text(`${currentPage}/${totalPages}`);
        $("#buttons .btn-sm").eq(0).prop("disabled", currentPage === 1);
        $("#buttons .btn-sm").eq(1).prop("disabled", currentPage === totalPages);
    }

    function fetchPage(page) {
        const code = $("#code").val();
        const start = $("#start").val();
        const end = $("#end").val();

        $.ajax({
            type: "get",
            url: "/data",
            data: { code, start, end, page },
            success: function(data) {
                $("#data").html(data);
                $("#buttons").show();
                currentPage = page;
                updateButtons();
            }
        });

        // 그래프 이미지 갱신
        $("#img1").attr("src", `/img1?code=${code}&start=${start}&end=${end}&t=${Date.now()}`);
        $("#img2").attr("src", `/img2?code=${code}&start=${start}&end=${end}&t=${Date.now()}`);
    }

    $("#search").on("click", function() {
        currentPage = 1;
        fetchPage(currentPage);
    });

    $("#buttons .btn-sm").eq(0).on("click", function() {
        if (currentPage > 1) {
            fetchPage(currentPage - 1);
        }
    });

    $("#buttons .btn-sm").eq(1).on("click", function() {
        if (currentPage < totalPages) {
            fetchPage(currentPage + 1);
        }
    });
</script>








